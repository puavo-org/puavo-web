/*
  Tables
*/

table {
  border-collapse: collapse;
}

th, td {
  vertical-align: middle;
  margin: 0;
  padding: 6px;
}

th {
  font-size: 110%;
  text-align: left;
  text-decoration: none;
}

/* Lists of schools, users, devices, etc. */
.list {
  width: 100%;
  color: $listFore;

  th {
    background: $listHeadingBack;
    color: $listHeadingFore;
    border-top: 1px solid $listHeadingBorder;
    border-left: 1px solid $listHeadingBorder;
    border-bottom: 1px solid $listHeadingBorder;
    padding: 10px;
    font-size: 100%;
  }

  tbody > tr:last-child {
    border-bottom: 1px solid $listHeadingBorder;
  }

  th:first-of-type {
    border-left: none;
  }

  tr {
    &:nth-child(odd) {
      background: $listOddRowBack;
    }

    &:nth-child(even) {
      background: $listEvenRowBack;
    }

    &:hover {
      background: $listRowHoverBack;
    }
  }

  td {
    border-left: 1px solid $listRowBorder;
  }

  td:first-of-type {
    border-left: none;
  }

  .form {
    margin-top: 20px;
    float: left;
  }

  input[type="text"] {
    width: 15em;
  }

  input[type="submit"] {
    paddin: 0;
    margin: 0;
    width: auto;
    height: auto;
    float: right;
  }

  @media #{$screen-breakpoint-one} {
    /* Minimize lists */
    width: 100%;

    .thead, th {
      display: none;
    }

    tbody > tr:last-child {
      border-bottom: none;
    }

    tr {
      display: block;
      padding: 2%;
      border-bottom: 1px solid $listRowBorder;
    }

    td {
      display: block;
      padding: 2px;
      border: none;
    }

    td:first-of-type {
      font-size: 120%;
      padding: 6px 2px;
    }

    td[data-title]:before {
      content: attr(data-title) ":\00A0";
      font-weight: bold;
    }

    .tableActions {
      display: inline-block;

      .btn {
        font-size: 90%;
        padding: 2px 10px;
      }
    }
  }

  .boolean {    /* Boolean column checkmarks */
    text-align: center;
    display: block;
    font-size: 200%;

    @media #{$screen-breakpoint-one} {
      display: inline;
      text-align: left;
      font-size: 100%;
    }
  }
}

/*
----------------------------------------------------------------------------------------------------
SUPERTABLES
----------------------------------------------------------------------------------------------------
*/

.stAdmin {
  color: $adminOwner;
}

.stControls .mobileTitle { display: none; }   /* Will be fixed later. Maybe. Hopefully. */

.superTable { }

/* The temporary mode warning indicator */
#stTemporaryMode {
    border: 1px solid var(--st-temporary-border);
    background: var(--st-temporary-bg);
    color: var(--st-temporary-fg);
    padding: 10px;
    font-size: 100%;
}

/* Container for the supertable and its controls */
.stControls {
    font-size: 100%;
    /*font-family: Cantarell, Ubuntu, Segoe UI, Arial, sans-serif;*/
}

.stControls button,
.stControls select {
    font-size: 100%;
    padding: 4px 10px;
    font-family: "Arial", "sans-serif";
}

.stControls button {
    border: 1px solid var(--st-buttons-border);
    background: var(--st-buttons-back);
    border-radius: 3px;
    padding: 4px 10px;
}

.stControls button:hover {
    border: 1px solid var(--st-buttons-hover-border);
    background: var(--st-buttons-hover-back);
}

.stControls button:disabled,
.stControls button.danger:disabled,
.stControls button:hover:disabled,
.stControls button.danger:hover:disabled {
    cursor: not-allowed;
    color: var(--st-buttons-disabled);
}

.stControls button.danger {
    border: 1px solid var(--st-buttons-danger-border);
    background: var(--st-buttons-danger-back);
    color: var(--st-buttons-danger-fore);
}

.stControls button.danger:hover {
    border: 1px solid var(--st-buttons-danger-border);
    background: var(--st-buttons-danger-hover-back);
    color: var(--st-buttons-danger-fore);
}

.stControls textarea {
    background: var(--st-textarea-bg);
    color: var(--st-textarea-fg);
    border: 1px solid var(--st-common-border);
    padding: 5px;
    width: 100%;
}

.stControls textarea:disabled {
    background: var(--st-textarea-disabled-bg);
    color: var(--st-textarea-disabled-fg);
}

.stControls fieldset {
    border: 1px solid var(--st-fieldset-border);
    margin: 0;
}

.stControls fieldset legend {
    margin-left: 0px;
}

.stControls summary {
    background: var(--st-summary-bg);
    color: var(--st-summary-fg);
    cursor: pointer;
    padding: 5px;
}

.stControls summary:hover {
    background: var(--st-summary-hover-bg);
    color: var(--st-summary-hover-fg);
}

.stControls details[open] {
    background: var(--st-details-open-bg);
    color: var(--st-details-open-fg);
}

.stControls details[open] > summary {
    background: var(--st-summary-hover-bg);
    color: var(--st-summary-hover-fg);
}

/* The SuperTable controls tab bar */
.stTabBar {
    list-style-type: none;
    margin: 0;
    padding: 0;
    display: flex;
}

.stTabBar li {
    display: inline;
    padding: 5px 20px;
    margin-right: 2px;
    background: var(--st-tab-bg);
    color: var(--st-tab-fg);
    border: 1px solid var(--st-controls-border);
    border-radius: 3px 3px 0 0;
    min-width: 150px;
    text-align: center;
    cursor: pointer;
}

.stTabBar li:hover {
    background: var(--st-tab-hover-bg);
    color: var(--st-tab-hover-fg);
}

.stTabBar li.selected {
    background: var(--st-tab-active-bg);
    color: var(--st-tab-active-fg);
    border-bottom: 1px solid var(--st-tab-active-bg);
    cursor: default;
    font-weight: bold;
}

.stTabBar li.disabled,
.stTabBar li.disabled:hover {
    background: var(--st-tab-disabled-bg);
    color: var(--st-tab-disabled-fg);
    cursor: not-allowed;
}

/* Tab container DIV */
.stTab {
    background: var(--st-tab-container-bg);
    color: var(--st-tab-container-fg);
    border: 1px solid var(--st-controls-border);
    margin-top: -1px;
    padding: 10px;
}

/* Column editing */
.stTab input[type="search"] {
    background: url("<%= image_path('magnifier.png') %>") no-repeat scroll 2px center;
    text-indent: 1.5em;
    border: 1px solid var(--st-controls-border);
    padding: 2px;
    min-width: 240px;
}

.stTab input[type="search"]::placeholder {
    font-style: italic;
}

.stTab .colList {
    width: 30em;
    height: 20em;
    border: 1px solid var(--st-common-border);
    overflow-x: hidden;
    overflow-y: scroll;
    resize: vertical;
    min-height: 5em;
}

.stTab .colList .column {
    display: flex;
    align-items: center;
    padding: 5px 10px;
    cursor: pointer;
}

.stTab .colList .column { color: var(--st-tab-container-fg); }
.stTab .colList .columnName { font-style: italic; pointer-events: none; }
.stTab .colList .column:hover { background: var(--st-columnlist-hover-bg); }
.stTab .colList .disabled { color: var(--st-columnlist-disabled-fg); }

.stTab .colList .column input {
    pointer-events: none;       /* The checkbox is there just for the looks */
    margin-right: 10px;
}

/* Some commonly used subtables in the SuperTable controls */
.stControls .commonTable {
    background: var(--st-commontable-bg);
    color: var(--st-commontable-fg);
}

.stControls .commonTable th {
    background: var(--st-commontable-th-bg);
    color: var(--st-commontable-th-fg);
}

.stControls .commonTable th,
.stControls .commonTable td {
    border: 1px solid var(--st-commontable-border);
    padding: 5px;
}

/* Supertable filtering */
.stFilters .unsaved {
    color: var(--st-filters-unsaved-fg);
}

.stFilters textarea {
    display: block;
    font-size: 140%;
}

.stFilters .toggleable {
    margin-top: 10px;
}

.stFilters .filterEditorWrapper {
    border: none;
    padding: 0;
}

.stFilters .filtersTable { width: 100%; }

.stFilters .filtersTable tr.row {      /* Must use .row, otherwise filter editor value tables are affected */
    border-top: 1px solid var(--st-filters-table-separator);
    border-bottom: 1px solid var(--st-filters-table-separator);
}

.stFilters .filtersTable td { padding: 2px 0; }

.stFilters .filtersTable .buttons {
    display: flex;
    flex-direction: rows;
    gap: 3px;
}

.stFilters .filtersTable .active {
    margin: 0 10px;
}

.stFilters .filtersTable .pretty {
    display: flex;
    flex-direction: rows;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    padding: 5px;
}

.stFilters .filtersTable .pretty:hover {
    background: var(--st-filters-pretty-hover-back);
}

.stFilters .filtersTable .pretty > * { pointer-events: none; }

.stFilters .filtersTable .pretty .column {
    padding-left: 3px;
    font-weight: bold;
    font-size: 100%;
}

.stFilters .filtersTable .pretty .operator {
    font-weight: bold;
    color: var(--st-filters-operator);
    font-size: 100%;
}

.stFilters .filtersTable .pretty .value {
    color: var(--st-filters-value);
    font-size: 100%;
}

.stFilters .filtersTable .pretty .empty {
    font-style: italic;
    color: var(--st-filters-value);
}

.stFilters .filtersTable .pretty .sep {
}

.stFilters .filtersTable .editorWrapper {
    background: var(--st-filters-editorwrapper-back);
    padding: 0;
    margin: 0;
}

.stFilters .filtersTable select#column {
    font-weight: bold;
    font-size: 100%;
}

.stFilters .filtersTable select#operator {
    font-weight: bold;
    color: var(--st-filters-operator);
    font-size: 100%;
}

.stFilters .filtersTable .openFilter {
    background: var(--st-filters-open-back);
    padding: 5px;
}

.stFilters .filtersTable .openFilter button#save i { color: var(--st-filters-save-icon); }
.stFilters .filtersTable .openFilter button#cancel i { color: var(--st-filters-cancel-icon); }

.stFilters .filtersTable .editor {
    font-size: 100%;
    margin: 0;
    padding: 5px;
}

.stFilters .filtersTable .editor p { margin: 0; }
.stFilters .filtersTable .editor table td { padding: 2px; }
.stFilters .filtersTable .editor input { color: var(--st-filters-value); }

.stFilters .filtersTable .editor table#values {
    margin-top: 5px;
}

.stFilters .jsonEditor {
    border: 1px solid #888;
}

.stFilters .invalidJSON {
    border: 1px solid red;
}

/* Filter parser messages table */
.stFilters .messages th {
    text-align: left;
    padding: 5px;
}

.stFilters .messages tbody tr {
    cursor: pointer;
}

.stFilters .messages td {
    border: 1px solid var(--st-common-border);
    padding: 3px;
}

.stFilters .messages .error {
    background: var(--st-filters-error-bg);
    color: var(--st-filters-error-fg);
}

/* Filter presets table */
.stFilters .presetsTable code {
    background: var(--st-commontable-code-bg);
    color: var(--st-commontable-code-fg);
    padding: 2px 5px;
    font-size: 120%;
    display: inline-block;
}

/* Column help table */
.stFilters .hiddenColumn {
    background: var(--st-columnhelp-invisible-bg);
    color: var(--st-columnhelp-invisible-fg);
}

.stFilters .columnHelp code {
    background: var(--st-commontable-code-bg);
    color: var(--st-commontable-code-fg);
    padding: 2px 5px;
    font-size: 120%;
    display: inline-block;
}

/* Mass tools */
.stMass div#massRowSelectSource {
    border: 1px solid var(--st-border);
    padding: 5px;
    font-size: 120%;
    outline: none;
    font-family: monospace;
    width: 30em;
    overflow: scroll;
    resize: both;
}

.stMass .unmatchedRow {
    background-color: var(--st-row-fail-bg);
}

.stMass progress {
    min-width: 250px;
    border-radius: 0;
}

.stMass .counter {
    font-weight: bold;
    font-size: 110%;
}

.stStatusOuter {
    border: 1px solid var(--st-status-border);
    display: flex;
}

/* The status box */
.stStatus {
    background: var(--st-status-bg);
    color: var(--st-status-fg);
    padding: 5px;
    font-size: 100%;
    min-height: 32px;
    display: flex;
    align-items: center;
    width: 30%;
}

.stStatus .success {
    background: var(--st-status-success-bg);
    color: var(--st-status-success-fg);
}

.stStatus .fail {
    background: var(--st-status-fail-bg);
    color: var(--st-status-fail-fg);
}

/* Pagination */
.stPaging {
    border-left: 1px solid var(--st-status-border);
    padding: 5px;
    flex-grow: 2;
}

.stPaging #pageCounter {
    font-size: 120%;
}

/* The update error message */
.stError {
    background: var(--st-error-bg);
    color: var(--st-error-fg);
    border: 1px solid var(--st-error-border);
    padding: 5px;
}

/* A wrapper DIV around the main table */
.stTableWrapper { }

/* The supertable itself */
.stTable {
    width: 100%;
    background: var(--st-bg);
    color: var(--st-fg);

    /*
    Sticky headers and collapsed cell borders do not mix beautifully; the header cells lose
    their borders. The workaround (read: hack) is to give the table top and right borders...
    */
    border-top: 1px solid var(--st-border);
    border-right: 1px solid var(--st-border);
    border-collapse: separate;
    border-spacing: 0;
}

.stTable td, .stTable th {
    /*
    ...and then set the opposite borders to cells. Now it looks nice again. I don't know how
    long this hack will continue to work.
    */
    border-bottom: 1px solid var(--st-border);
    border-left: 1px solid var(--st-border);
    padding: 5px;
}

.stTable th {
    /*background: var(--st-header-bg);*/
    background: $listHeadingBack;
    color: var(--st-header-fg);
    text-align: left;

    /* Make the header cells sticky. Also see the notice above about disappearing cell borders. */
    position: sticky;
    top: 38px;  /* WARNING! Empirically determined! Will break in the future! */
}

.stTable th.sortable:hover {
    background: $stTableHeaderHoverBackground;
    color: var(--st-sortable-hover-fg);
}

.stTable td {
    padding: 5px;
    font-size: 100%;
}

/* Supertable sort header cells */
.stTable th div {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    pointer-events: none;
}

.stTable th div span {
    display: inline;
}

.stTable th div span.arrow {
    margin-left: auto;
    font-family: puavo-icons;
    font-weight: normal;
    padding-left: 5px;
}

/* Row hover and row state interactions */
.stTable th.sorted { background: $stTableHeaderHoverBackground; }
.stTable .sorted { background: var(--st-row-sorted-column); }
.stTable tbody tr:hover { background: var(--st-row-hover-bg); }
.stTable tbody tr:hover .sorted { background: var(--st-row-sorted-hover-bg); }

.stTable tbody tr.success {
    background: var(--st-row-success-bg);
    color: var(--st-row-processed-fg) !important;
}

.stTable tbody tr.success:hover { background: var(--st-row-success-hover-bg) !important; }
.stTable tbody tr.success .sorted { background: var(--st-row-success-sorted-bg); }
.stTable tbody tr.success:hover .sorted { background: var(--st-row-success-sorted-hover-bg) !important; }

.stTable tbody tr.fail {
    background: var(--st-row-fail-bg);
    color: var(--st-row-processed-fg) !important;
}

.stTable tbody tr.fail:hover { background: var(--st-row-fail-hover-bg) !important; }
.stTable tbody tr.fail .sorted { background: var(--st-row-fail-sorted-bg); }
.stTable tbody tr.fail:hover .sorted { background: var(--st-row-fail-sorted-hover-bg) !important; }

/* Row checkboxes */
.stTable .headerCheckbox {
    display: block;
    width: 20px;
    height: 20px;
}

.stTable .checkbox {
    /* Prevent text/table cell selections during range selections */
    user-select: none;
}

.stTable .checkbox span {
    border: 1px solid var(--st-checkbox-border);
    display: block;
    width: 20px;
    height: 20px;
    background: var(--st-checkbox-bg);
    background-repeat: no-repeat;
    background-position: 50% 50%;
    pointer-events: none;
}

.stTable .checkbox span.checked {
    background-image: url("/images/cross.svg");
    background-color: var(--st-checkbox-bg);
    background-size: 80%;
}

/* The previously selected row indicator */
.stTable .previousRow { outline: 2px dotted var(--st-previous-row); }

/* Supertable cell header drag item */
.stDragHeader {
    background: $stTableHeaderHoverBackground;
    color: var(--st-sortable-hover-fg);
    border: 1px solid var(--st-border);
    position: absolute;
    display: flex;
    align-items: center;
    padding: 5px;
    margin: 0;
    font-weight: bold;
    z-index: 10;
    cursor: grabbing;
    opacity: 0.85;
    user-select: none;
}

/* Supertable drop target position indicator */
.stDropMarker {
    background: var(--st-dropmarker);
    border: none;
    position: absolute;
    width: 5px;
    display: block;
    z-index: 9;
}
