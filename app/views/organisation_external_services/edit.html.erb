<% page_title t('titles.organisation'), t('titles.external_services'), t('titles.edit') %>

<h1><%= t('external_services.edit.title') %></h1>

<% if @external_services.empty? %>
<p class="genericError"><%= t('external_services.edit.no_external_services_found') %></p>
<div class="cancel"><%= link_to t('link.back'), organisation_external_services_path, class: 'btn' %></div>
<% else %>
<p><%= t('external_services.services_count', count: @external_services.count) %></p>

<%= form_tag('/users/organisation_external_services/update', method: :post) do %>
<table class="list">
    <thead>
        <tr>
            <th class="minimize-width"><%= t('external_services.is_active') %></th>
            <th><%= t('external_services.service_title') %></th>
            <th><%= t('external_services.service_description') %></th>
            <th>Domain</th>
            <th><%= t('external_services.email') %></th>
            <th><%= t('external_services.path_prefix') %></th>
            <th class="minimize-width">DN</th>
            <th class="minimize-width nowrap"><%= t('ldap_create_time') %></th>
        </tr>
    </thead>
    <tbody>
<% @external_services.each do |es| %>
        <tr>
            <td class="minimize-width nowrap"><input type="checkbox" id="<%= es[:dn] %>" style="display: block; width: 100%;" name="<%= es[:dn] %>" <%= es[:active] ? 'checked' : '' %> autocomplete="off"></td>
            <td><%= es[:name] %></td>
            <td><%= es[:description] %></td>
            <td><%= es[:domains].join('<br>').html_safe %></td>
            <td><%= es[:email] %></td>
            <td><%= es[:prefix] %></td>
            <td class="minimize-width nowrap"><%= es[:dn] %></td>
            <td class="minimize-width nowrap"><%= utc_timestamp_for_localization(es[:created]) %></td>
        </tr>
<% end %>
    </tbody>
</table>

<div class="flex-cols gap-10px margin-top-10px">
    <%= submit_tag t('link.save'), class: 'btn', autocomplete: 'off' %>
    <div class="cancel"><%= link_to t('link.back'), organisation_external_services_path, class: 'btn' %></div>
</div>

<% end %>
<% end %>
