<script>
// Rules and strings for the password validator
const PASSWORD_RULES = [
<% rules.each do |r| %>
    {
        type: "<%= r[:type] %>",
        operator: "<%= r[:operator].html_safe %>",
        value: <%= (r[:type] == 'length') ? r[:raw_value] : "new RegExp(/#{r[:raw_value]}/)" %>,
        message: "<%= t("activeldap.errors.messages.password_validation.#{r[:message_id]}") %>",
    },
<% end %>
];

const CONFIRM_MISMATCH = "<%= t('flash.password.confirmation_failed') %>";

initializePasswordValidator("<%= password_field_id %>", "<%= confirm_field_id %>", "<%= callback %>");
</script>
